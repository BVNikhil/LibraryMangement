<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="jquery36.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#clk").click(function () {
                $("#libraryForm").toggle();
            });
        });
    </script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Library</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <img src="images/books.png" alt="logo" height="20" />
        <a class="navbar-brand" href="#">Library</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                </li>
            </ul>

            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" id="searchTxt" type="search" placeholder="Search"
                    aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" id="btn">Search</button>
            </form>
        </div>
    </nav>
    <br>
    <h1>My Library</h1>
    <br>
    <div class="container my-3">
        <div><button class="btn btn-outline-secondary" type="button" id="clk">Show/Hide</button></div>
        <br>
        <form id="libraryForm">
            <div class="form-group row">
                <label for="bookName" class="col-sm-2 col-form-label">Name</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="bookName" placeholder="Book Name">
                </div>
            </div>
            <div class="form-group row">
                <label for="Author" class="col-sm-2 col-form-label">Author</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="author" placeholder="Author">
                </div>
            </div>
            <div class="form-group row">
                <label for="Date" class="col-sm-2 col-form-label">Publish Date</label>
                <div class="col-sm-10">
                    <input type="date" class="form-control" id="dt" placeholder="date">
                </div>
            </div>
            <fieldset class="form-group">
                <div class="row">
                    <legend class="col-form-label col-sm-2 pt-0">Type</legend>
                    <div class="col-sm-10">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="type" id="fiction" value="fiction"
                                checked>
                            <label class="form-check-label" for="fiction">
                                Fiction
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="type" id="programming"
                                value="programming">
                            <label class="form-check-label" for="programming">
                                Computer Programming
                            </label>
                        </div>
                        <div class="form-check disabled">
                            <input class="form-check-input" type="radio" name="type" id="others" value="others">
                            <label class="form-check-label" for="Others">
                                Others
                            </label>
                        </div>
                    </div>
                </div>
            </fieldset>

            <div class="form-group row">
                <div class="col-sm-10">
                    <button type="submit" class="btn btn-primary">Add Book</button>
                </div>
            </div>
        </form>
        <div id="message"></div>

        <br />
        <div id="table">
            <h2>Your books</h2><br />

            <table class="table table-striped" id="tab">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Author</th>
                        <th scope="col">Date</th>
                        <th scope="col">Type</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Book 10</td>
                        <td>Mr.A</td>
                        <td>20/01/2002</td>
                        <td>others</td>
                    </tr>
                </tbody>

                <tbody id='tableBody'></tbody>
            </table>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="index.js"></script> -->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js">
    </script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-app.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAoN0YI5Qbwy0zt3y6r1psFmrT492BX8ro",
            authDomain: "library-management-3511b.firebaseapp.com",
            databaseURL: "https://library-management-3511b-default-rtdb.firebaseio.com",
            projectId: "library-management-3511b",
            storageBucket: "library-management-3511b.appspot.com",
            messagingSenderId: "794507695913",
            appId: "1:794507695913:web:cbc7f2fc5ca3a2f3a74938",
            measurementId: "G-8Q2XQ9XHKR"
        };
        firebase.initializeApp(firebaseConfig);
        const app = initializeApp(firebaseConfig);
        // const analytics = getAnalytics(app);

        var messagesRef = firebase.database().ref('Collected Data');

        document.getElementById('libraryForm').addEventListener('submit', submitForm);

        function submitForm(e) {
            e.preventDefault();

            // Get values
            let name = document.getElementById('bookName').value;
            let author = document.getElementById('author').value;
            let date = document.getElementById('dt').value;
            let type;
            let fiction = document.getElementById('fiction');
            let programming = document.getElementById('programming');
            let others = document.getElementById('others');

            if (fiction.checked) {
                type = fiction.value;
            }
            else if (programming.checked) {
                type = programming.value;
            }
            else if (others.checked) {
                type = others.value;
            }
            saveMessage(name, author, date, type);
            document.getElementById('libraryForm').reset();
        }

        // Function to get form values
        function getInputVal(id) {
            return document.getElementById(id).value;
        }

        // Save message to firebase
        function saveMessage(name, author, date, type) {
            var newMessageRef = messagesRef.push();
            newMessageRef.set({
                name: name,
                author: author,
                date: date,
                type: type,
            });
        }


        const dbRef = firebase.database().ref();
        const usersRef = dbRef.child('users');
        const userListUI = document.getElementById("table");
        usersRef.on("child_added", snap => {
            let user = snap.val();
            var table = document.getElementById("tab");
            var row = table.insertRow();
            var c1 = row.insertCell(0);
            var c2 = row.insertCell(1);
            var c3 = row.insertCell(2);
            var c4 = row.insertCell(3);
            c1.innerHTML = user.name;
            c2.innerHTML = user.author;
            c3.innerHTML = user.date;
            c4.innerHTML = user.type;
        });

        const dbRef1 = firebase.database().ref();
        const usersRef1 = dbRef.child('Collected Data');
        const userListUI1 = document.getElementById("table");
        usersRef1.on("child_added", snap => {
            let user = snap.val();
            var table = document.getElementById("tab");
            var row = table.insertRow();
            var c1 = row.insertCell(0);
            var c2 = row.insertCell(1);
            var c3 = row.insertCell(2);
            var c4 = row.insertCell(3);
            c1.innerHTML = user.name;
            c2.innerHTML = user.author;
            c3.innerHTML = user.date;
            c4.innerHTML = user.type;
        });
    </script>
    <script>
        $(document).ready(function () {
            $("#btn").click(function () {
                var input, filter, ul, tr, a, i, txtValue;
                input = document.getElementById('searchTxt');
                filter = input.value.toUpperCase();
                ul = document.getElementById("tab");
                tr = ul.getElementsByTagName('tr');
                for (i = 0; i < tr.length; i++) {
                    a = tr[i].getElementsByTagName("tr");
                    txtValue = a.textContent || a.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            });
        });
    </script>
</body>

</html>